[![DOI](https://zenodo.org/badge/173927847.svg)](https://zenodo.org/badge/latestdoi/173927847)

# Generate graphs from strucrues of mathematical knowledge

## Python code

Run script by executing `python main.py`

### Required python packeges

use your favourite package installer to install the following packages:

- [pygraphviz](https://pygraphviz.github.io/)
- [numpy](http://www.numpy.org/)
- [networkx](https://networkx.github.io/)

### Input

The input data is read from `data.csv` with `;` as a delimiter. The first row/line is the names of the observed variables.

The first entry in each line is discarded.

The script prompts for the size of each sample (once). By default this is set to 20.

### Output

The script parses the data in `data.csv` and generates `.dot` files for each sample and outputs it to the output directory `./output/dot/`. The scripts also prompts if one wishes to export the graphs to `.png`, these are outputted to the directory `./output/png/`

## Pseudo code for the algorithm

### Latent variables

From a dichotomous response $m\times n$ matrix $A$ the routine `LATENTMATRIX` generates latent variables and returns a matrix $B$. The augmented matrix $[A|B]$ encodes the relationship between the observed and latent variables.

Each row of $A$ can be considered as a bitstring of length $n$, a row $u$ of $A$ is a **substructure** of a row $v$ of $A$ if and only if $u\,\mathrm{AND}\, v = u$, where $\mathrm{AND}$ is the bitwise and-operator.

```
BEGIN LATENTMATRIX
  INPUT: matrix A
  LET B be an empty matrix with number of rows same as matrix A
  FOR EACH row x OF A
    IF x has not been observed
      add new latent variable by resizing matrix B with 1 column and set all new entries to 0
      SET B(x, number of columns of B) to 2
    ENDIF
    FOR EACH row y OF A UP TO row x
      IF row y is substructure of row x
        SET B(x,indexOf(latentvariable corresponding to row y) to 1
      ENDIF
      IF row x is substructure of row y
        SET B(y, indexOf(latentvariable corresponding to row x) to 1
      ENDIF
  RETURN B
END LATENTMATRIX
```

### Adjecency matrix

The routine `ADJECENCYMATRIX` generates adjecency matrices $C$ and $C’$ for graphs $\Gamma$ and $\Gamma'$ (transitive reduction of $\Gamma$) from input matrix $A$ and latent variable matrix $B$

```
BEGIN ADJECENCYMATRIX
INPPUT: matrix A and latent variable matrix B ( LATENTMATRIX(A) )
LET M be the augmented matrix [ A | B ]
LET C be a zero-matrix of size n x n, where n is number of columns of M

FOR EACH column c OF M
	FOR EACH index i OF c with c(i) equal to 1
		LET r be row i of M
		IF THERE EXISTS r(j) equal to 2
			SET C(indexOf(c), j) to 1
    ENDIF

LET C’ be the transitive reduction of C
RETURN C and C’
END ADJECENCYMATRIX
```

### Note on the uniqueness of graphs generated by the algorithm

The algorithm will always produce adjecency matrices for graphs up to graph isomorphism under permutation of rows of the response matrix, that is directed graphs that only differ up to the labeling of the nodes.
